# Activity Monitor

```{r echo=TRUE, message=FALSE}
library(dplyr)
library(data.table)
```


### Download the data from the source URL
```{r echo=TRUE}
if (!file.exists("../Data/activity.zip")) {
    url <- "https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip"
    zfile="../Data/activity.zip"
    download.file(url, zfile)
    unzip(zipfile=zfile, exdir="../Data")
}
```

### Load data from the downloaded file, add id column with sequential unique value
```{r echo=TRUE}
df <- read.csv("../Data/Activity.csv")
df <- mutate(df, id = rownames(df))

```


### Ignore Missing Values
```{r echo=TRUE}
noNA <- na.omit(df)

```


### 1. What is the total number of steps taken per day?
```{r echo=TRUE}
noNA <- data.table(noNA, key="date")
dailySteps <- noNA [,sum(steps), by=key(noNA)]
setnames(dailySteps, "V1", "steps")
head(dailySteps)
```

### Histogram of the total number of steps taken per day 
(excluded missing values)
```{r echo=TRUE}
cuts <- cut(dailySteps$steps,  c(0,5000, 10000, 15000, 20000, 25000), 
           labels=c("5000",  "10000",  "15000", "20000", "25000"))
summary(cuts)

hist(dailySteps$steps, col="green", 
      main="Daily Steps Histogram", xlab="daily steps")
rug(dailySteps$steps)
abline(v=median(dailySteps$steps), lwd=4, col="blue")
```


```{r echo=TRUE}
summary(dailySteps)
```


### 2. The Average Daily Activity pattern
- Make a time series plot (type="1") 
- X-Axis is 5-minute intervals, and y-axis the averaged across all days
```{r echo=TRUE}

vy <- tapply(noNA$steps, noNA$interval, mean)
vx <- as.integer(names(vy))
plot(vx, vy, type="l", xlab="Intervals", 
     ylab="Average Steps", 
     main="Average Daily Activity Pattern")

```

- The 5-minute interval that has the maximum number of steps

```{r echo=TRUE}
z <- as.data.frame(vy)
vy[which(z$vy == max(z$vy))]

```



### 3. Imputing missing values
The presense of missing days may introduce bias into some calculations or summaries of data.

#### The toal number of missing values in the dataset. (rows with NA)
```{r echo=TRUE}
nrow(subset(df, is.na(steps) ==TRUE))

```


### Fill missing data with imputed mean values 
```{r echo=TRUE,  message=FALSE}

library(Hmisc)
df.i <- with(df, impute(steps, mean))
df$impmean <- as.integer(df.i)

```


```{r echo=TRUE}
dt <- data.table(df, key="date")
ds <- dt[,sum(impmean), by=key(dt)]
setnames(ds, "V1", "impmean")
```


- Make a historam of the total number of steps taken each day

```{r echo=TRUE}

hist(ds$impmean, col="green",  
     main="Daily Steps Histogram with Imputed Mean Values", xlab="daily steps")
rug(ds$impmean)
abline(v=median(ds$impmean), lwd=4, col="blue")

```

There is a little difference in mean and median values.

```{r echo=TRUE}
summary(ds)
```

- It appears there is little impact of imputing missing data on the estimates of the total daily number of steps.



### 4. Are there differences in activity patterns between weekdays and weekends?
- Create a new factor variable in the dataset with two levels – “weekday” and “weekend” indicating whether a given date is a weekday or weekend day.

- Make a panel plot containing a time series plot (i.e. type = "l") of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all weekday days or weekend days (y-axis). See the README file in the GitHub repository to see an example of what this plot should look like using simulated data.

Reshape dataset
```{r echo=TRUE}
dt[,"asDate"] <- as.Date(dt[,date])
dt[,"wday"] <- weekdays(dt$asDate)
```



